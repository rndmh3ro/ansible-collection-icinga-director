- hosts: localhost
  connection: local
  gather_facts: false
  collections:
    - t_systems_mms.icinga_director
  vars:
    icinga_url: "http://icinga/icingaweb2"
    icinga_user: "icingaadmin"
    icinga_pass: "icinga"
  tasks:
    - shell: 'curl -H "Accept: application/json" -vL -k -u icingaadmin:icinga "http://icinga/icingaweb2/director/hosts"'
      ignore_errors: true
    - shell: 'curl -H "Accept: application/json" -vL -k -u icingaadmin:icinga "https://icinga/icingaweb2/director/hosts"'
      ignore_errors: true
    - shell: 'curl -H "Accept: application/json" -vL -k "http://icinga/"'
      ignore_errors: true
    - shell: 'curl -H "Accept: application/json" -vL -k "https://icinga/"'
      ignore_errors: true

    - shell: 'curl -H "Accept: application/json" -vL -k "https://localhost/"'
      ignore_errors: true
    - shell: 'curl -H "Accept: application/json" -vL -k "http://localhost/"'
      ignore_errors: true

    - include_tasks: "{{ item }}"
      loop:
        - ./icinga_command.yml
        - ./icinga_command_template.yml
        - ./icinga_timeperiod.yml
        - ./icinga_user_template.yml
        - ./icinga_user.yml
        #- ./icinga_notification.yml
        - ./icinga_hostgroup.yml
        - ./icinga_servicegroup.yml
        - ./icinga_service_template.yml
        - ./icinga_service_apply.yml
        #- ./icinga_hostgroup.yml
        #- ./icinga_host.yml
